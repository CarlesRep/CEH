## Detecci√≥n del Sistema Operativo (OSINT pasivo)
La identificaci√≥n remota del sistema operativo y servicios expuestos ‚Äîsin interactuar directamente con la v√≠ctima‚Äî permite priorizar vectores de ataque o estimar la superficie de riesgo.
### üïµÔ∏è‚Äç‚ôÇÔ∏è Herramientas principales
#### üîç SHODAN
- Permite buscar **dispositivos conectados** a Internet (routers, servidores, IoT, etc.).
- Filtra por puerto, servicio, banner, pa√≠s, etc.
- Muestra informaci√≥n del sistema operativo, versi√≥n, ubicaci√≥n y puertos abiertos.

üåê https://www.shodan.io

##### üéØ 10 queries de Shodan que debes conocer

|   |   |   |
|---|---|---|
|Objetivo|Ejemplo de query|Explicaci√≥n|
|Web server y SO|`port:80 "Server:"`|Extrae banner `Server:` (Apache, nginx‚Ä¶)|
|Windows RDP abierto|`port:3389 os:"Windows"`|Identifica hosts RDP ‚Üí CVEs BlueKeep, etc.|
|C√°maras IP gen√©ricas|`port:554 has_screenshot:true`|RTSP + captura de imagen (CCTV)|
|Hikvision CCTV|`port:554 product:"Hikvision"`|C√°maras Hikvision por marca|
|Dahua DVR expuesto|`port:37777 product:Dahua`|DVR/TCP propietario de Dahua|
|"netcam" devices|`netcam`|Banner com√∫n en c√°maras gen√©ricas|
|PLC Siemens S7|`port:102 "Siemens"`|ICS/SCADA expuestos|
|MongoDB sin auth|`product:"MongoDB" "Unauthorized"`|Bases sin contrase√±a|
|Routers MikroTik Winbox|`port:8291 "MikroTik"`|Hist√≥ricamente vulnerables (CVE‚Äë2018‚Äë14847)|
|Exim 4.x vulnerable|`product:Exim "4.8"`|Email con RCE hist√≥rica|

_Tip:_ A√±ade `country:ES` o `org:"MiEmpresa"` para delimitar.

#### üåê Censys
Motor de b√∫squeda que ofrece una vista completa de **dispositivos y servidores expuestos**, proporciona detalles como:
- Indexa banners completos TLS/HTTP/SMTP, certificados y metadatos de localizaci√≥n.
- Sintaxis estilo Lucene: `services.service_name:"rdp" AND location.country_code:"ES"`.
- Colecciones **hosts** (IPv4/IPv6) y **certificates** (PKI).
- Permite pivoteo: explora hosts que comparten cert com√∫n (infra compartida).

üåê https://censys.io

#### ##### Ejemplos de consultas en Censys

|   |   |   |
|---|---|---|
|Objetivo|Query Censys|Qu√© obtienes|
|RDP p√∫blico en Espa√±a|`services.service_name:"rdp" AND location.country_code:"ES"`|IPs + banner TLS|
|Cert CN *.local autofirmado|`parsed.names:"*.local" AND parsed.validity_days>398`|Posible AD interno expuesto|
|C√°maras GoAhead|`services.http.response.html_title:"GoAhead"`|C√°maras/routers embebidos|

>[!NOTE] Ambas herramientas son √∫tiles para **fingerprinting pasivo**, sin interactuar directamente con el objetivo.

## Geolocalizaci√≥n de Direcciones IP
La geolocalizaci√≥n IP permite identificar datos como:
- Pa√≠s, ciudad, regi√≥n, c√≥digo postal  
- Zona horaria y velocidad de conexi√≥n  
- Proveedor de servicios (ISP)  
- Dominio asociado  
- C√≥digo de √°rea, operadora m√≥vil  
- Coordenadas GPS, estaci√≥n meteorol√≥gica  

### Herramientas de geolocalizaci√≥n IP
- **IP2Location** https://www.ip2location.com
- **IP Location Finder**

Estas herramientas ayudan a recolectar informaci√≥n √∫til sobre un objetivo, que puede emplearse en ataques como:
- **Phishing**
- **Ingenier√≠a social**
- **Spam geolocalizado**

> üîé Ejemplo: Saber que una IP pertenece a Microsoft y est√° en Singapur puede guiar ataques espec√≠ficos o suplantaci√≥n dirigida.

## Extracci√≥n de Informaci√≥n DNS
Los registros DNS revelan datos clave sobre:
- **Ubicaci√≥n** y **tipo de servidores**
- Infraestructura de red y roles de cada host
- Puntos potenciales para ataques de ingenier√≠a social o t√©cnicos

### Tipos de registros DNS importantes

| Tipo   | Descripci√≥n                                       |
|--------|---------------------------------------------------|
| A      | Apunta a la IP de un host                         |
| MX     | Servidor de correo del dominio                    |
| NS     | Servidor de nombres (name server)                 |
| CNAME  | Alias can√≥nico para un host                       |
| SOA    | Autoridad del dominio                             |
| SRV    | Servicios del dominio                             |
| PTR    | IP ‚Üî nombre de host (resoluci√≥n inversa)          |
| RP     | Persona responsable del dominio                   |
| HINFO  | Informaci√≥n de hardware del host (CPU y SO)       |
| TXT    | Texto libre (DKIM, SPF, validaciones, etc.)       |
### Herramientas de consulta DNS
- **SecurityTrails**
- **NSLOOKUP**
- **Dig**
- **dnsdumpster** https://dnsdumpster.com
- **DNS Records** 

> Ejemplo: con SecurityTrails se puede ver el hist√≥rico de IPs A asignadas a un dominio como `certifiedhacker.com`.

## Reverse DNS Lookup (Resoluci√≥n Inversa)
El objetivo es descubrir el **nombre de dominio asociado a una direcci√≥n IP**, buscando el registro DNS **PTR** correspondiente.

### ¬øPara qu√© sirve?
- Identificar hosts internos o mal configurados
- Obtener nombres de dominios asociados a IPs externas
- Apoyar tareas de fingerprinting o ingenier√≠a social

### Herramientas utilizadas
- **DNSRecon**
- **MXToolbox (online)** https://mxtoolbox.com
- **Comandos `dig -x` o `nslookup`**

```bash
dnsrecon -r 162.241.216.0/24
```

En el ejemplo, se resuelven m√∫ltiples IPs del rango 162.241.216.0/24 a `bluehost.com` y `unifiedlayer.com`, lo cual permite identificar el proveedor.

### Resultado t√≠pico
- Registro **PTR** ‚Üí Nombre de dominio (ej. `162.241.216.11` ‚Üí `box5531.bluehost.com`)
- - TTL y autoridad del servidor

